
============== Tạo bảng Clean_1 ( Chỉ có tiêu đề cột \ chưa tạo dữ liệu ) 

select top 0 * 
into Social_Media_Clean_1 from [Students Social Media Addiction];

============== Thêm dữ liệu vào Clean_1 ( lọc các dòng trùng, định dạng kiểu dữ liệu, check NULL)

INSERT INTO Social_Media_Clean_1
SELECT DISTINCT
    TRY_CAST(Student_ID AS INT) AS Student_ID,
    TRY_CAST(Age AS INT) AS Age,
    TRIM(CAST(Gender AS NVARCHAR(50))) AS Gender,
    TRIM(CAST(Academic_Level AS NVARCHAR(100))) AS Academic_Level,
    TRIM(CAST(Country AS NVARCHAR(100))) AS Country,
    TRY_CAST(Avg_Daily_Usage_Hours AS FLOAT) AS Avg_Daily_Usage_Hours,
    TRIM(CAST(Most_Used_Platform AS NVARCHAR(100))) AS Most_Used_Platform,
    TRIM(CAST(Affects_Academic_Performance AS NVARCHAR(10))) AS Affects_Academic_Performance,
    TRY_CAST(Sleep_Hours_Per_Night AS FLOAT) AS Sleep_Hours_Per_Night,
    TRY_CAST(Mental_Health_Score AS INT) AS Mental_Health_Score,
    TRIM(CAST(Relationship_Status AS NVARCHAR(50))) AS Relationship_Status,
    TRY_CAST(Conflicts_Over_Social_Media AS INT) AS Conflicts_Over_Social_Media,
    TRY_CAST(Addicted_Score AS INT) AS Addicted_Score
FROM [Students Social Media Addiction]
WHERE 
    Student_ID IS NOT NULL
    AND Age IS NOT NULL
    AND Gender IS NOT NULL
    AND Country IS NOT NULL;